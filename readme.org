
#+HTML_HEAD:
#+TITLE: emacs 中的字符界面中国象棋
#+AUTHOR: zhcosin
#+DATE:
#+OPTIONS:   ^:{} \n:t 
#+LANGUAGE: zh-CN

* 概述

这是一个 emacs 中的字符界面的中国象棋，效果如下
[[./chess.gif]]
目前尚未处于开发阶段，开发进度如下
 - [X] 字符界面表示层(界面绘制，棋盘坐标与缓冲区位置互相转换)
 - [X] 内核框架(对弈方，兵种，棋子，棋局，棋步等)
 - [X] 走子/吃子规则(将帅不可见面尚未完成)
 - [X] 棋局上快速移动光标(方向键或 hjkl 类 evil 操作)
 - [X] 胜负判决(目前依据是将帅被吃掉)
 - [ ] 中文棋步术语
 - [ ] 将军判断
 - [X] 棋步历史与悔棋
 - [X] 棋局导出与加载
 - [ ] 去除 evil 依赖
 - [ ] 人机对战(极大极小搜索算法)
   
* 用法
  
** 尝试

 - 在 emacs 中打开项目中的 chess-cn.el 文件.
 - 执行 eval-buffer 命令加载文件内容.
  
** 永久配置 
   
配置文件中增加以下两行
#+BEGIN_SRC elisp
(add-to-list 'load-path "path/to/chess-cn.el")
(require 'chess-cn)
#+END_SRC


** 开新局
  对弈的正确姿势:
 - 执行 chess-cn--new 命令，会打开一个名为 *chess-cn* 的缓冲区并绘制有初始棋局.
 - 初始棋步红蓝任意一方均可进行，走子方法，按方向键(或者 hjkl 四个键，类 evil) 移动光标，按回车键选中要走的棋子，再移动到目标位置按回车键(目标位置无棋子为移动，有对方棋子为吃子，有己方棋子为重新选择要走的棋子).
 - 红蓝双方交替进行走子，直到游戏结束.
   
** 悔棋
   
 执行 chess-cn--undo 命令即可.
   
** 保存棋局

 - 执行 chess-cn--save 命令，会保存棋到变量 chess-cn--saved-dir 指定目录下以时间戳命名并以 .chess 为后缀的文件中.
   棋局文件中主要保存以下信息: 当前棋局、棋步历史、当前走子方，当前选子坐标，对弈是否已结束，文件内容是一个 list 对象，人工可读.

** 加载棋局

 - 执行 chess-cn--load 命令，选择棋局文件即可，默认展开到变量 chess-cn--saved-dir 指定目录.

* 依赖

目前暂时依赖 evil (后续将去除).

* 注意事项

 - 中英文对齐，需要使用等宽字体，只要搞定了 org-mode 的中英文表格对齐就不会有问题


